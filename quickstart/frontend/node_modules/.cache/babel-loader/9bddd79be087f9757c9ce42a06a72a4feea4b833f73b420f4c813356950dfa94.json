{"ast":null,"code":"import React,{useState,useCallback,useEffect}from'react';import{backendApi}from'../services/backendApi';import{LoopWalletConnector}from'../wallet/LoopWalletConnector';// CBTC network admin party on DevNet\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CBTC_INSTRUMENT_ADMIN='cbtc-network::12202a83c6f4082217c175e29bc53da5f2703ba2675778ab99217a5a881a949203ff';const CBTC_INSTRUMENT_ID='CBTC';// ClearportX operator party\nconst CLEARPORTX_OPERATOR='ClearportX-DEX-1::122081f2b8e29cbe57d1037a18e6f70e57530773b3a4d1bea6bab981b7a76e943b37';// Singleton Loop connector instance\nlet loopConnector=null;function getLoopConnector(){if(!loopConnector){loopConnector=new LoopWalletConnector();LoopWalletConnector.initOnce();}return loopConnector;}/**\n * DevNet-only UI component for accepting incoming CBTC offers.\n *\n * Option A Flow:\n * 1. User pastes TransferOffer contractId\n * 2. Backend fetches registry choice-context and exercises TransferInstruction_Accept as ClearportX\n * 3. Acceptance creates CBTC Holding owned by ClearportX\n * 4. Backend polls for the new holding using HoldingSelectorService\n */export default function DevNetCbtcAccept(){const[transferOfferCid,setTransferOfferCid]=useState('');const[isAccepting,setIsAccepting]=useState(false);const[isPolling,setIsPolling]=useState(false);const[result,setResult]=useState(null);const[existingHoldings,setExistingHoldings]=useState([]);const[isLoadingHoldings,setIsLoadingHoldings]=useState(false);const[incomingOffers,setIncomingOffers]=useState([]);const[isLoadingOffers,setIsLoadingOffers]=useState(false);const[acceptingOfferId,setAcceptingOfferId]=useState(null);const[useLoopSdk,setUseLoopSdk]=useState(true);// Default to Loop SDK\nconst[loopConnected,setLoopConnected]=useState(false);const[loopConnecting,setLoopConnecting]=useState(false);// Load incoming CBTC offers for ClearportX\nconst loadIncomingOffers=useCallback(async()=>{setIsLoadingOffers(true);try{console.log('[DevNetCbtcAccept] Loading incoming CBTC offers...');const offers=await backendApi.getCbtcOffers(CLEARPORTX_OPERATOR);console.log('[DevNetCbtcAccept] Received offers:',offers);setIncomingOffers(offers.map(o=>({contractId:o.contractId,sender:o.sender,receiver:o.receiver,amount:o.amount,reason:o.reason,instrumentId:o.instrumentId,transferInstructionId:o.transferInstructionId,packageId:o.packageId})));}catch(err){console.error('[DevNetCbtcAccept] Failed to load offers:',err);}finally{setIsLoadingOffers(false);}},[]);// Load existing CBTC holdings for ClearportX\nconst loadExistingHoldings=useCallback(async()=>{setIsLoadingHoldings(true);try{const holdings=await backendApi.getCbtcHoldings(CLEARPORTX_OPERATOR);setExistingHoldings(holdings.map(h=>({contractId:h.contractId,amount:h.amount,owner:h.owner})));}catch(err){console.error('Failed to load existing holdings:',err);}finally{setIsLoadingHoldings(false);}},[]);// Check Loop connection status on mount\nuseEffect(()=>{const checkLoop=async()=>{if(useLoopSdk){const connector=getLoopConnector();const status=await connector.checkConnected();setLoopConnected(status.connected);}};checkLoop();},[useLoopSdk]);// Auto-load offers and holdings on mount\nuseEffect(()=>{loadIncomingOffers();loadExistingHoldings();},[loadIncomingOffers,loadExistingHoldings]);// Connect to Loop wallet\nconst connectLoop=useCallback(async()=>{setLoopConnecting(true);try{const connector=getLoopConnector();await connector.connectFromClick();// Must be called from user click\nconst status=await connector.checkConnected();setLoopConnected(status.connected);if(!status.connected){setResult({ok:false,error:'Loop connection failed. Please allow popups and try again.'});}}catch(err){console.error('[DevNetCbtcAccept] Loop connection error:',err);setResult({ok:false,error:(err===null||err===void 0?void 0:err.message)||'Failed to connect Loop wallet'});setLoopConnected(false);}finally{setLoopConnecting(false);}},[]);// Accept CBTC offer via Loop SDK\nconst acceptOfferViaLoop=useCallback(async offer=>{const requestId=\"loop-accept-\".concat(Date.now(),\"-\").concat(Math.random().toString(36).substring(2,9));console.log(\"[DevNetCbtcAccept] request_id=\".concat(requestId,\" Starting Loop SDK acceptance...\"));if(!offer.transferInstructionId){setResult({ok:false,error:'Missing transferInstructionId - cannot accept via Loop SDK',hint:'This offer may be from an older version. Try backend acceptance.'});return;}setIsAccepting(true);setAcceptingOfferId(offer.contractId);setResult(null);try{const connector=getLoopConnector();// Ensure connected\nconst connStatus=await connector.ensureConnected(requestId);if(!connStatus.connected){setResult({ok:false,error:'Loop wallet not connected',hint:'Click \"Connect Loop Wallet\" button first'});setIsAccepting(false);setAcceptingOfferId(null);return;}console.log(\"[DevNetCbtcAccept] request_id=\".concat(requestId,\" Loop connected, calling acceptIncomingCbtcOffer with TI CID=\").concat(offer.transferInstructionId.substring(0,20),\"...\"));const acceptResult=await connector.acceptIncomingCbtcOffer({transferInstructionCid:offer.transferInstructionId,receiverParty:CLEARPORTX_OPERATOR,packageId:offer.packageId});console.log(\"[DevNetCbtcAccept] request_id=\".concat(requestId,\" Loop SDK response:\"),acceptResult);if(!acceptResult.success||!acceptResult.updateId){setResult({ok:false,error:acceptResult.error||'Loop SDK acceptance failed',hint:'Check browser console for details',requestId});setIsAccepting(false);setAcceptingOfferId(null);return;}console.log(\"[DevNetCbtcAccept] request_id=\".concat(requestId,\" Acceptance successful, updateId=\").concat(acceptResult.updateId));// Poll backend for the new holding\nsetIsAccepting(false);setIsPolling(true);const holdingResult=await backendApi.selectHolding({ownerParty:CLEARPORTX_OPERATOR,instrumentAdmin:CBTC_INSTRUMENT_ADMIN,instrumentId:CBTC_INSTRUMENT_ID,minAmount:'0',timeoutSeconds:30,pollIntervalMs:2000});setIsPolling(false);setAcceptingOfferId(null);if(holdingResult.found){console.log(\"[DevNetCbtcAccept] request_id=\".concat(requestId,\" Holding found: cid=\").concat(holdingResult.holdingCid,\", amount=\").concat(holdingResult.amount));setResult({ok:true,ledgerUpdateId:acceptResult.updateId,holdingCid:holdingResult.holdingCid||undefined,amount:holdingResult.amount||undefined,elapsedMs:holdingResult.elapsedMs,requestId,transferInstructionId:offer.transferInstructionId});// Refresh lists\nawait loadIncomingOffers();await loadExistingHoldings();}else{console.warn(\"[DevNetCbtcAccept] request_id=\".concat(requestId,\" Holding not found after acceptance\"));setResult({ok:false,ledgerUpdateId:acceptResult.updateId,error:holdingResult.error||'Holding not found after acceptance',elapsedMs:holdingResult.elapsedMs,requestId,transferInstructionId:offer.transferInstructionId});}}catch(err){const errorMsg=(err===null||err===void 0?void 0:err.message)||String(err);console.error(\"[DevNetCbtcAccept] request_id=\".concat(requestId,\" Loop SDK exception:\"),errorMsg,err);setResult({ok:false,error:errorMsg,requestId});setIsAccepting(false);setIsPolling(false);setAcceptingOfferId(null);}},[loadIncomingOffers,loadExistingHoldings]);// Accept CBTC offer via backend registry-powered endpoint\nconst acceptOffer=useCallback(async offerCid=>{const requestId=\"accept-\".concat(Date.now(),\"-\").concat(Math.random().toString(36).substr(2,9));console.log(\"[DevNetCbtcAccept] request_id=\".concat(requestId,\" Starting acceptance for offerCid=\").concat(offerCid.substring(0,20),\"...\"));setIsAccepting(true);setAcceptingOfferId(offerCid);setResult(null);try{console.log(\"[DevNetCbtcAccept] request_id=\".concat(requestId,\" Calling backend accept...\"));const acceptResult=await backendApi.acceptCbtcOffer(offerCid,CLEARPORTX_OPERATOR);console.log(\"[DevNetCbtcAccept] request_id=\".concat(requestId,\" Backend accept response:\"),acceptResult);if(!acceptResult.ok){setResult({ok:false,error:acceptResult.rawError||'Acceptance failed',hint:acceptResult.hint,classification:acceptResult.classification,requestId:acceptResult.requestId||requestId,transferInstructionId:acceptResult.transferInstructionId});setIsAccepting(false);setAcceptingOfferId(null);return;}console.log(\"[DevNetCbtcAccept] request_id=\".concat(requestId,\" Acceptance successful, ledgerUpdateId=\").concat(acceptResult.ledgerUpdateId));// Step 2: Poll backend for the new holding\nsetIsAccepting(false);setIsPolling(true);const holdingResult=await backendApi.selectHolding({ownerParty:CLEARPORTX_OPERATOR,instrumentAdmin:CBTC_INSTRUMENT_ADMIN,instrumentId:CBTC_INSTRUMENT_ID,minAmount:'0',timeoutSeconds:30,pollIntervalMs:2000});setIsPolling(false);setAcceptingOfferId(null);if(holdingResult.found){console.log(\"[DevNetCbtcAccept] request_id=\".concat(requestId,\" Holding found: cid=\").concat(holdingResult.holdingCid,\", amount=\").concat(holdingResult.amount));setResult({ok:true,ledgerUpdateId:acceptResult.ledgerUpdateId||undefined,holdingCid:holdingResult.holdingCid||undefined,amount:holdingResult.amount||undefined,elapsedMs:holdingResult.elapsedMs,requestId:acceptResult.requestId||requestId,transferInstructionId:acceptResult.transferInstructionId});// Refresh offers and holdings lists\nawait loadIncomingOffers();await loadExistingHoldings();}else{console.warn(\"[DevNetCbtcAccept] request_id=\".concat(requestId,\" Holding not found after acceptance\"));setResult({ok:false,ledgerUpdateId:acceptResult.ledgerUpdateId||undefined,error:holdingResult.error||'Holding not found after acceptance',elapsedMs:holdingResult.elapsedMs,requestId:acceptResult.requestId||requestId,transferInstructionId:acceptResult.transferInstructionId});}}catch(err){const errorMsg=(err===null||err===void 0?void 0:err.message)||String(err);console.error(\"[DevNetCbtcAccept] request_id=\".concat(requestId,\" Exception:\"),errorMsg,err);setResult({ok:false,error:errorMsg,requestId});setIsAccepting(false);setIsPolling(false);setAcceptingOfferId(null);}},[loadIncomingOffers,loadExistingHoldings]);// Handle manual accept from input field\nconst handleAccept=useCallback(async()=>{if(!transferOfferCid.trim()){setResult({ok:false,error:'Please enter a TransferOffer contract ID'});return;}await acceptOffer(transferOfferCid.trim());},[transferOfferCid,acceptOffer]);// Handle one-click accept from offers list\nconst handleAcceptFromList=useCallback(async offer=>{if(useLoopSdk){await acceptOfferViaLoop(offer);}else{await acceptOffer(offer.contractId);}},[useLoopSdk,acceptOfferViaLoop,acceptOffer]);// Truncate contract ID for display\nconst truncateCid=cid=>{if(!cid||cid.length<=24)return cid;return\"\".concat(cid.substring(0,12),\"...\").concat(cid.substring(cid.length-8));};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white dark:bg-dark-800 rounded-2xl shadow-lg p-6 border border-gray-200 dark:border-dark-700\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-900 dark:text-white\",children:\"CBTC Accept (DevNet)\"}),/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 text-xs font-medium bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200 rounded-full\",children:\"Option A\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 dark:text-gray-400 mb-4\",children:\"Accept incoming CBTC TransferOffers via backend registry choice-context or Loop SDK. The acceptance creates a CBTC Holding owned by ClearportX operator.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 p-4 bg-gray-50 dark:bg-dark-700 rounded-xl border border-gray-200 dark:border-dark-600\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm font-medium text-gray-700 dark:text-gray-300\",children:\"Acceptance Mode:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setUseLoopSdk(false),className:\"px-4 py-2 text-sm font-medium rounded-lg transition-all \".concat(!useLoopSdk?'bg-blue-500 text-white shadow':'bg-white dark:bg-dark-600 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-dark-500'),children:\"Backend\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setUseLoopSdk(true),className:\"px-4 py-2 text-sm font-medium rounded-lg transition-all \".concat(useLoopSdk?'bg-purple-500 text-white shadow':'bg-white dark:bg-dark-600 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-dark-500'),children:\"Loop SDK\"})]})]}),useLoopSdk&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 pt-3 border-t border-gray-200 dark:border-dark-600\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full \".concat(loopConnected?'bg-green-500':'bg-gray-400')}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600 dark:text-gray-400\",children:loopConnected?'Loop Wallet Connected':'Loop Wallet Not Connected'})]}),!loopConnected&&/*#__PURE__*/_jsx(\"button\",{onClick:connectLoop,disabled:loopConnecting,className:\"px-4 py-2 text-sm font-medium rounded-lg transition-all \".concat(loopConnecting?'bg-gray-400 text-white cursor-not-allowed':'bg-purple-500 text-white hover:bg-purple-600 shadow hover:shadow-lg'),children:loopConnecting?'Connecting...':'Connect Loop'})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\",children:\"TransferOffer Contract ID\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:transferOfferCid,onChange:e=>setTransferOfferCid(e.target.value),placeholder:\"Paste the TransferOffer contractId here...\",className:\"w-full px-4 py-3 bg-gray-50 dark:bg-dark-700 border border-gray-200 dark:border-dark-600 rounded-xl text-sm text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all\",disabled:isAccepting||isPolling})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAccept,disabled:isAccepting||isPolling||!transferOfferCid.trim(),className:\"w-full py-3 px-4 rounded-xl font-semibold text-white transition-all \".concat(isAccepting||isPolling||!transferOfferCid.trim()?'bg-gray-400 cursor-not-allowed':'bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 shadow-lg hover:shadow-xl'),children:isAccepting?/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center justify-center\",children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\",xmlns:\"http://www.w3.org/2000/svg\",fill:\"none\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}),useLoopSdk?'Accepting via Loop SDK...':'Accepting via backend...']}):isPolling?/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center justify-center\",children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\",xmlns:\"http://www.w3.org/2000/svg\",fill:\"none\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}),\"Polling for Holding...\"]}):\"Accept CBTC via \".concat(useLoopSdk?'Loop SDK':'Backend')})]}),result&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 p-4 rounded-xl \".concat(result.ok?'bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800':'bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800'),children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold mb-2 \".concat(result.ok?'text-green-800 dark:text-green-200':'text-red-800 dark:text-red-200'),children:result.ok?'Success!':'Failed'}),result.ok?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 text-sm text-green-700 dark:text-green-300\",children:[result.transferInstructionId&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"TI CID:\"}),' ',/*#__PURE__*/_jsx(\"code\",{className:\"bg-green-100 dark:bg-green-800 px-2 py-0.5 rounded text-xs\",children:truncateCid(result.transferInstructionId)})]}),result.holdingCid&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Holding CID:\"}),' ',/*#__PURE__*/_jsx(\"code\",{className:\"bg-green-100 dark:bg-green-800 px-2 py-0.5 rounded text-xs\",children:truncateCid(result.holdingCid)})]}),result.amount&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Amount:\"}),\" \",result.amount,\" CBTC\"]}),result.elapsedMs!==undefined&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Time:\"}),\" \",result.elapsedMs,\"ms\"]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 text-sm text-red-700 dark:text-red-300\",children:[/*#__PURE__*/_jsx(\"p\",{children:result.error}),result.hint&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs opacity-75\",children:[\"Hint: \",result.hint]}),result.requestId&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs opacity-75\",children:[\"Request ID: \",result.requestId]}),result.ledgerUpdateId&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs opacity-75\",children:[\"Update ID: \",result.ledgerUpdateId]}),result.classification&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs opacity-75\",children:[\"Classification: \",result.classification]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 pt-6 border-t border-gray-200 dark:border-dark-700\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-gray-900 dark:text-white\",children:\"Incoming CBTC Offers\"}),/*#__PURE__*/_jsx(\"button\",{onClick:loadIncomingOffers,disabled:isLoadingOffers,className:\"text-sm text-blue-600 dark:text-blue-400 hover:underline disabled:opacity-50\",children:isLoadingOffers?'Loading...':'Refresh'})]}),isLoadingOffers?/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center py-4\",children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin h-5 w-5 text-blue-500\",xmlns:\"http://www.w3.org/2000/svg\",fill:\"none\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-sm text-gray-500\",children:\"Loading offers...\"})]}):incomingOffers.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 dark:text-gray-400 py-2\",children:\"No incoming CBTC offers found for ClearportX.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:incomingOffers.map((offer,idx)=>/*#__PURE__*/_jsx(\"div\",{className:\"p-4 bg-gradient-to-r from-orange-50 to-yellow-50 dark:from-orange-900/20 dark:to-yellow-900/20 rounded-xl border border-orange-200 dark:border-orange-800\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-lg text-gray-900 dark:text-white\",children:[offer.amount,\" CBTC\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-0.5 text-xs bg-orange-100 dark:bg-orange-800 text-orange-800 dark:text-orange-200 rounded-full\",children:\"Pending\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500 dark:text-gray-400 space-y-0.5\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"From:\"}),' ',/*#__PURE__*/_jsx(\"code\",{className:\"bg-gray-100 dark:bg-gray-800 px-1 rounded\",children:truncateCid(offer.sender)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Contract:\"}),' ',/*#__PURE__*/_jsx(\"code\",{className:\"bg-gray-100 dark:bg-gray-800 px-1 rounded\",children:truncateCid(offer.contractId)})]}),offer.transferInstructionId&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"TI:\"}),' ',/*#__PURE__*/_jsx(\"code\",{className:\"bg-gray-100 dark:bg-gray-800 px-1 rounded\",children:truncateCid(offer.transferInstructionId)})]}),offer.reason&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Reason:\"}),\" \",offer.reason]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAcceptFromList(offer),disabled:isAccepting||isPolling||acceptingOfferId===offer.contractId,className:\"px-4 py-2 rounded-lg font-semibold text-sm transition-all \".concat(acceptingOfferId===offer.contractId?'bg-yellow-400 text-yellow-900 cursor-wait':isAccepting||isPolling?'bg-gray-300 text-gray-500 cursor-not-allowed':'bg-gradient-to-r from-green-500 to-emerald-600 text-white hover:from-green-600 hover:to-emerald-700 shadow hover:shadow-lg'),children:acceptingOfferId===offer.contractId?/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin -ml-1 mr-2 h-4 w-4\",xmlns:\"http://www.w3.org/2000/svg\",fill:\"none\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}),\"Accepting...\"]}):'Accept'})]})},offer.contractId||idx))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 pt-6 border-t border-gray-200 dark:border-dark-700\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-gray-900 dark:text-white\",children:\"ClearportX CBTC Holdings\"}),/*#__PURE__*/_jsx(\"button\",{onClick:loadExistingHoldings,disabled:isLoadingHoldings,className:\"text-sm text-blue-600 dark:text-blue-400 hover:underline disabled:opacity-50\",children:isLoadingHoldings?'Loading...':'Refresh'})]}),existingHoldings.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 dark:text-gray-400\",children:\"No CBTC holdings found. Click Refresh to load.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:existingHoldings.map((holding,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 bg-gray-50 dark:bg-dark-700 rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm\",children:/*#__PURE__*/_jsx(\"code\",{className:\"text-xs text-gray-600 dark:text-gray-400\",children:truncateCid(holding.contractId)})}),/*#__PURE__*/_jsxs(\"div\",{className:\"font-semibold text-gray-900 dark:text-white\",children:[holding.amount,\" CBTC\"]})]},holding.contractId||idx))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-200 dark:border-blue-800\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-blue-800 dark:text-blue-200 mb-2\",children:\"How it works\"}),/*#__PURE__*/_jsxs(\"ol\",{className:\"list-decimal list-inside text-sm text-blue-700 dark:text-blue-300 space-y-1\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"Paste the TransferOffer contractId from the sender\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Loop SDK accepts the offer (has TI visibility)\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Acceptance creates a CBTC Holding owned by ClearportX\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Backend polls for the new holding using UTXO selection\"})]})]})]});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}