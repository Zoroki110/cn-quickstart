# Copyright (c) 2025, Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.
# SPDX-License-Identifier: 0BSD

server:
  forward-headers-strategy: NATIVE
  # Review Error settings here and set acceptable values for production use.
  # This configuration is for development purposes.
  error:
    include-message: always
    include-binding-errors: always
    include-stacktrace: always
    include-path: always
    include-exception: true
  port: ${BACKEND_PORT}

logging:
  level:
    org.apache.coyote.http11.Http11InputBuffer: DEBUG
    com.digitalasset.quickstart.oauth.Interceptor: DEBUG
    org.springframework: ERROR
    org.springframework.security: INFO
#    org.springframework.security.web.FilterChainProxy: TRACE

management:
  endpoints:
    web:
      exposure:
        include: '*'
  health:
    redis:
      enabled: false


ledger:
  application-id: ${AUTH_APP_PROVIDER_BACKEND_USER_ID:AppId}
  registry-base-uri: ${REGISTRY_BASE_URI}

# Access to the application is restricted to authorized end users from organization (e.g. AppProvider, AppUser) registered as tenant.
# Backend service starts with a single AppProvider internal tenant. Additional tenant registration is available through
# the /admin/tenant-registrations endpoint.
application:
  tenants:
    AppProvider:
      tenantId: AppProvider
      partyId: ${APP_PROVIDER_PARTY}
      internal: true
  clearportx:
    dexPartyId: ${CLEARPORTX_DEX_PARTY_ID:}

# CORS configuration for frontend integration
# NOTE: Spring Security CORS does NOT support wildcard subdomains (*.ngrok-free.dev)
# You must add the exact ngrok URL here when ngrok restarts with a new URL
cors:
  allowed-origins: ${CORS_ALLOWED_ORIGINS:https://app.clearportx.com,http://localhost:3000,http://localhost:3001,http://localhost:4001,https://nonexplicable-lacily-leesa.ngrok-free.dev}
  allow-credentials: true
  allowed-methods: GET,POST,PUT,DELETE,OPTIONS,HEAD
  allowed-headers: Authorization,Content-Type,X-Idempotency-Key,X-Request-ID
  exposed-headers: Retry-After,X-Request-ID,Authorization,X-Total-Count,X-Rate-Limit-Remaining
  max-age: 3600

clearportx:
  auth:
    jwt-secret: ${CLEARPORTX_AUTH_JWT_SECRET:devnet-secret}
    jwt-issuer: ${CLEARPORTX_AUTH_JWT_ISSUER:clearportx-backend}
    jwt-ttl-seconds: ${CLEARPORTX_AUTH_JWT_TTL_SECONDS:900}
  history:
    path: ${CLEARPORTX_HISTORY_PATH:/tmp/clearportx-history.json}
