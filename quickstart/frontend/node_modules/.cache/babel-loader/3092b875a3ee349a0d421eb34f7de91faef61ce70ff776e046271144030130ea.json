{"ast":null,"code":"import{useCallback,useEffect,useState}from\"react\";import{apiGet}from\"../api/client\";export function useLegacyBalances(partyId){const[balances,setBalances]=useState({});const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const fetchBalances=useCallback(async()=>{if(!partyId){setBalances({});setError(null);setLoading(false);return;}setLoading(true);try{const rows=await apiGet(\"/api/wallet/tokens/\".concat(encodeURIComponent(partyId)));const list=Array.isArray(rows)?rows:[];const map=list.reduce((acc,entry)=>{var _entry$symbol,_entry$symbol$toUpper,_ref,_entry$amount;const symbol=entry===null||entry===void 0?void 0:(_entry$symbol=entry.symbol)===null||_entry$symbol===void 0?void 0:(_entry$symbol$toUpper=_entry$symbol.toUpperCase)===null||_entry$symbol$toUpper===void 0?void 0:_entry$symbol$toUpper.call(_entry$symbol);if(!symbol){return acc;}const decimals=typeof entry.decimals===\"number\"?entry.decimals:10;const current=acc[symbol];const nextAmount=toNumber((_ref=(_entry$amount=entry.amount)!==null&&_entry$amount!==void 0?_entry$amount:entry.balance)!==null&&_ref!==void 0?_ref:entry.quantity)+(current?toNumber(current.amount):0);acc[symbol]={amount:Number.isFinite(nextAmount)?nextAmount.toString():\"0\",decimals};return acc;},{});setBalances(map);setError(null);}catch(err){console.warn(\"Failed to load wallet tokens for \".concat(partyId),err);setError(err instanceof Error?err:new Error(\"Failed to load balances\"));setBalances({});}finally{setLoading(false);}},[partyId]);useEffect(()=>{if(!partyId){setBalances({});setError(null);setLoading(false);return;}fetchBalances();},[partyId,fetchBalances]);return{balances,loading,error,reload:fetchBalances};}function toNumber(value){if(typeof value===\"number\"){return Number.isFinite(value)?value:0;}if(typeof value===\"string\"){const parsed=Number(value);return Number.isFinite(parsed)?parsed:0;}return 0;}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}